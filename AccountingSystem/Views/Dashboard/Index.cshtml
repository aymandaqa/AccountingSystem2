@using System.Globalization
@model AccountingSystem.ViewModels.Dashboard.CashPerformanceDashboardViewModel

@{
    ViewData["Title"] = "لوحة التحكم";
    var culture = new CultureInfo("ar-SA");
    Func<decimal, string> format = value => string.Format(culture, "{0:N2}", value);
}

<div class="container-fluid py-4">
    <div class="row g-4 mb-4">
        <div class="col-12 col-md-6 col-xl-3">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="text-muted small mb-2">مستحقات العملاء في الطريق</div>
                    <div class="fs-4 fw-semibold">@format(Model.TotalCustomerDuesOnRoad)</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="text-muted small mb-2">النقد مع السائقين في الطريق</div>
                    <div class="fs-4 fw-semibold">@format(Model.TotalCashWithDriverOnRoad)</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="text-muted small mb-2">مستحقات العملاء</div>
                    <div class="fs-4 fw-semibold">@format(Model.TotalCustomerDues)</div>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="text-muted small mb-2">النقد في خزنة الفرع</div>
                    <div class="fs-4 fw-semibold">@format(Model.TotalCashOnBranchBox)</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm border-0">
        <div class="card-body">
            <h5 class="card-title mb-4">تقرير أداء السيولة حسب الفروع</h5>

            @if (!Model.HasRecords)
            {
                <div class="alert alert-info mb-0">لا توجد بيانات للعرض.</div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-striped table-bordered align-middle text-center">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">كود الفرع</th>
                                <th scope="col">اسم الفرع</th>
                                <th scope="col">مستحقات العملاء في الطريق</th>
                                <th scope="col">النقد مع السائقين في الطريق</th>
                                <th scope="col">مستحقات العملاء</th>
                                <th scope="col">النقد في خزنة الفرع</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var record in Model.Records)
                            {
                                <tr>
                                    <td>@(string.IsNullOrWhiteSpace(record.BranchCode) ? "-" : record.BranchCode)</td>
                                    <td class="text-start">@record.BranchName</td>
                                    <td>@format(record.CustomerDuesOnRoad)</td>
                                    <td>@format(record.CashWithDriverOnRoad)</td>
                                    <td>@format(record.CustomerDues)</td>
                                    <td>@format(record.CashOnBranchBox)</td>
                                </tr>
                            }
                        </tbody>
                        <tfoot class="table-light fw-semibold">
                            <tr>
                                <td colspan="2" class="text-center">الإجمالي</td>
                                <td>@format(Model.TotalCustomerDuesOnRoad)</td>
                                <td>@format(Model.TotalCashWithDriverOnRoad)</td>
                                <td>@format(Model.TotalCustomerDues)</td>
                                <td>@format(Model.TotalCashOnBranchBox)</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            }
        </div>
    </div>
</div>
