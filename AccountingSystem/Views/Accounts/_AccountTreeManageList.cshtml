@model IEnumerable<AccountingSystem.ViewModels.AccountViewModel>

@if (!Model.Any())
{
    <div class="text-center text-muted py-5">
        <i class="fas fa-layer-group fa-2x mb-3"></i>
        <p class="mb-0">لا توجد حسابات فرعية لعرضها.</p>
    </div>
}
else
{
    foreach (var account in Model)
    {
        var hasChildren = account.HasChildren;
        <div class="list-account-item d-flex flex-column flex-md-row justify-content-between gap-3">
            <div class="d-flex align-items-start gap-3">
                <span class="text-primary mt-1">
                    <i class="fas @(hasChildren ? "fa-folder" : "fa-file") fa-lg"></i>
                </span>
                <div>
                    <div class="d-flex align-items-center gap-2 flex-wrap">
                        <span class="fw-semibold">@account.NameAr</span>
                        <span class="text-muted small">(@account.Code)</span>
                        <span class="badge bg-light text-dark border">@account.AccountType.ToString()</span>
                        <span class="badge bg-info text-dark">@account.CurrencyCode</span>
                        <span class="badge @(account.CanPostTransactions ? "bg-success" : "bg-warning text-dark")">
                            @(account.CanPostTransactions ? "قابل للترحيل" : "غير قابل للترحيل")
                        </span>
                        @if (!account.IsActive)
                        {
                            <span class="badge bg-danger">غير نشط</span>
                        }
                    </div>
                    <div class="text-muted small mt-1">
                        <span class="me-3"><i class="fas fa-balance-scale-left"></i> رصيد افتتاحي: @account.OpeningBalance.ToString("N2")</span>
                        <span class="me-3"><i class="fas fa-coins"></i> الرصيد الحالي: @account.CurrentBalance.ToString("N2")</span>
                        @if (!string.IsNullOrWhiteSpace(account.BranchName))
                        {
                            <span><i class="fas fa-code-branch"></i> الفرع: @account.BranchName</span>
                        }
                    </div>
                </div>
            </div>
            <div class="d-flex flex-column align-items-md-end align-items-start gap-2">
                <div class="btn-group btn-group-sm">
                    <a href="@Url.Action("Details", new { id = account.Id })" class="btn btn-outline-info" title="التفاصيل">
                        <i class="fas fa-eye"></i>
                    </a>
                    <a href="@Url.Action("Edit", new { id = account.Id })" class="btn btn-outline-warning ajax-modal" title="تعديل">
                        <i class="fas fa-edit"></i>
                    </a>
                    <a href="@Url.Action("Create", new { parentId = account.Id })" class="btn btn-outline-primary ajax-modal" title="إضافة حساب فرعي">
                        <i class="fas fa-plus"></i>
                    </a>
                    @if (account.CanPostTransactions)
                    {
                        <a href="@Url.Action("AccountStatement", "Reports", new { accountId = account.Id })" class="btn btn-outline-success" title="كشف الحساب">
                            <i class="fas fa-file-alt"></i>
                        </a>
                    }
                    <button type="button" class="btn btn-outline-danger" onclick="deleteAccount(@account.Id)" title="حذف">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="text-muted small">
                    المستوى: @account.Level
                    @if (hasChildren)
                    {
                        <span class="ms-2"><i class="fas fa-sitemap"></i> يحتوي على حسابات فرعية</span>
                    }
                </div>
            </div>
        </div>
    }
}
